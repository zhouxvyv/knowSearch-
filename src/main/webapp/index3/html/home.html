<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link rel="stylesheet" href="../css/indexCSS.css">
    <link rel="stylesheet" href="../css/head.css">
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script src="../js/jquery-form-3.51.0.js"></script>
</head>
<body style="background-color: #fcfcfc">

<div style="width: 100%;height: 60px;background-color: white">
    <div id="header">
        <div id="loge"><a href="home.html">
            <img src="../image/loge.gif" alt="">
        </a></div>
        <div id="firstClass" class="kind" style="max-width: 7%">
            <!--热门课题-->
            分类
            <ul>
                <li><a>全部</a></li>
                <li><a>试卷</a></li>
                <li><a>课程</a></li>
                <li><a>科目</a></li>
            </ul>
        </div>
        <div id="secondClass" class="kind" style="max-width: 7%">
            <!--自然科学类-->
            考研
            <ul>
                <li><a>数学</a></li>
                <li><a>英语</a></li>
                <li><a>政治</a></li>
                <li><a>专业(用户)</a></li>
            </ul>
        </div>
        <div id="thirdClass" class="kind">
            <!--人文和社会科学类-->
            我的课程
            <ul>
                <li><a>高数</a></li>
                <li><a>政治</a></li>
                <li><a>英语</a></li>
                <li><a>大学物理</a></li>
                <li><a>数据库</a></li>
            </ul>
        </div>
        <div class="kind forthClass">
            <a href="../../TangYu/html/DailyPracticeToday.html">每日一练</a>
        </div>
        <div class="kind forthClass">
            帮助和反馈
        </div>

        <div id="loge1">
            <div><span></span><span></span><span></span></div>
            <div id="content">
                <ul class="list1">
                    <li class="item1">
                        <a href="">listItem</a>
                        <ul class="list2">
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                        </ul>
                    </li>
                    <li class="item1">
                        <a href="">listItem</a>
                        <ul class="list2">
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                        </ul>
                    </li>
                    <li class="item1">
                        <a href="">listItem</a>
                        <ul class="list2">
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                        </ul>
                    </li>
                    <li class="item1">
                        <a href="">listItem</a>
                        <ul class="list2">
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                        </ul>
                    </li>
                    <li class="item1">
                        <a href="">listItem</a>
                        <ul class="list2">
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                            <li class="item2"><a href="">item</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div>
            <!--用户信息-->
            <div id="user"><!--隐含用户列表-->
                <div style="height: 60px">
                    <div id="avatar">
                        <img src="" alt="">
                    </div>
                    <div id="name">
                        <p>周诩</p>
                        <div>退出</div>
                    </div>
                    <ul>
                        <li><a href="/project/html/home.html">个人资料</a></li>
                        <li><a href="/project/html/account.html">账号设置</a></li>
                        <li><a href="/project/html/mistake.html">错题集</a></li>
                        <li><a href="/project/html/collection.html">收藏夹</a></li>
                        <li><a href="/project/html/record.html">搜题记录</a></li>
                        <li><a href="/project/html/lesson.html">我的课程</a></li>
                        <li id="logout"><a>退出登录</a></li>
                    </ul>
                </div>
            </div>
            <div id="noUser">
                <div style="height: 60px">
                    <div id="noAvatar">
                        <img src="/index3/image/noAvatar.png" alt="">
                    </div>
                    <div id="noName">
                        <p>未登录</p>
                        <div>登录</div>
                        <div>注册</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="mainer">
    <form action="/readFileServlet.Servlets" method="post" id="searcherMain" enctype="multipart/form-data" >
        <input id="input" name="text" type="text">
        <input id="readFile" type="file" name="avatar" style="display: none">
        <button id="search" type="button">搜索</button>
        <button id="imageSearch" type="button"></button>
    </form>
</div>
<div style="width: 350px;margin: 0 auto;display: none;transform: translate(0,-100px)" id="loginContainer">
    <div id="close" style="width: 12px;height: 12px;position: absolute;transform: translate(315px,10px)"><img style="width: 100%;height: 100%" src="/index2/image/img_2.png" alt=""></div>
    <div id="login-mainer" style="width: 350px;height: 335px;background-color: #2aabd2;border-radius: 20px">
        <h2 style="height: 60px;font-size: 30px;line-height: 60px;width: 350px;text-align: center">知否-登录</h2>
        <form action="" onsubmit="return false">
            <div style="height: 60px;width: 350px;padding: 0 25px">
                <label style="display: inline-block;width: 60px;height: 40px;float: left;font-size: 18px;text-align: center;line-height: 40px;letter-spacing: 3px">账号:</label>
                <input id="submit_no" type="text" name="no" style="display: inline-block;width: 235px;height: 40px;outline: 0;float: left;border: 2px solid #88ddee;border-radius: 10px;padding-left: 12px">
                <p id="submit_no_alert" style="display: block;width: 300px;height: 20px;font-size: 12px;float: left;line-height: 18px;padding-left: 80px;color: red;"></p>
            </div>
            <div style="height: 60px;width: 350px;padding: 0 25px">
                <label style="display: inline-block;width: 60px;height: 40px;float: left;font-size: 18px;text-align: center;line-height: 40px;letter-spacing: 3px">密码:</label>
                <input id="submit_pwd" type="password" name="pwd"style="display: inline-block;width: 235px;height: 40px;outline: 0;float: left;border: 2px solid #88ddee;border-radius: 10px;padding-left: 12px">
                <p id="submit_pwd_alert" style="display: block;width: 300px;height: 20px;font-size: 12px;float: left;line-height: 18px;padding-left: 80px;color: red;"></p>
            </div>
            <div style="height: 60px;width: 350px;padding: 0 25px">
                <label style="display: inline-block;width: 60px;height: 40px;float: left;font-size: 18px;text-align: center;line-height: 40px;">验证码:</label>
                <input id="submit_code" type="text" name="pwd"style="display: inline-block;width: 135px;height: 40px;outline: 0;float: left;border: 2px solid #88ddee;border-radius: 10px;padding-left: 12px">
                <div id="code" style="margin-left: 3px;width: 97px;height: 40px;float: left;border-radius: 5px;overflow: hidden"><img style="width: 100%;height: 100%" src="/createCodeImageServlet.Servlet" alt=""></div>
                <p id="submit_code_alert" style="display: block;width: 300px;height: 20px;font-size: 12px;float: left;line-height: 18px;padding-left: 80px;color: red;"></p>
            </div>
            <div style="height: 60px;width: 350px;padding: 0 25px">
                <button id="submit" style="cursor: pointer;margin: 0 13px 0 47px;height: 40px;width: 90px;float: left;border-radius: 5px;border: 2px solid #88ddee;background-color: #4fa0ff;font-size: 20px;font-weight: bold;color: white;">登&nbsp;&nbsp;录</button>
                <button id="keepsubmit" style="cursor: pointer;margin: 0 47px 0 13px;height: 40px;width: 90px;float: left;border-radius: 5px;border: 2px solid #88ddee;background-color: green;font-size: 18px;font-weight: bold;color: white">保持登录</button>
                <p style="width: 300px;height: 30px;line-height: 30px;padding-left: 80px;font-size: 14px">还没有账号,去<a href="home.html" style="font-size: 18px;line-height: 30px;text-decoration: none">注册</a>一个</p>
            </div>
        </form>
        <script>
            var flickerNo = 0
            var flickerNoRun = ""
            var flickerPwd = 0
            var flickerPwdRun = ""
            var flickerCode = 0
            var flickerCodeRun = ""
            var keep = 0
            var isOkCodeFlag = false;
            function isOkNo(){

                var no=$("#submit_no").val()
                if(no===undefined || no.length===0){
                    $("#submit_no_alert").text("用户名不能为空..")
                    return false
                }
                else if(no.length<6){
                    $("#submit_no_alert").text("用户名格式不规范,不能少于六位..")
                    return false
                }
                $("#submit_no_alert").text("")
                return true

            }
            function isOkPwd(){
                var pwd=$("#submit_pwd").val()
                if(pwd===undefined || pwd.length===0){
                    $("#submit_pwd_alert").text("密码不能为空..")
                    return false
                }
                else if(pwd.length<6){
                    $("#submit_pwd_alert").text("密码不能少于6位..")
                    return false
                }

                $("#submit_pwd_alert").text("")

                return true;
            }
            function isOkCode(){
                var code = $("#submit_code").val()
                $.ajax({
                    url: "/checkCodeServlet.Servlet",
                    type: "post",
                    dataType: "json",
                    data: {
                        code: code
                    },
                    success: function (data){
                        isOkCodeFlag = data.success
                        if(!isOkCodeFlag)
                            $("#submit_code_alert").text(data.message)
                        else
                            $("#submit_code_alert").text("")
                    }
                })
            }
            $("#submit_no").change(function (e){
                isOkNo()
            })
            $("#submit_code").change(function (e){
                isOkCode()
            })
            $("#submit").click(function (){
                keep="N"
                checkLogin()
            })
            $("#keepsubmit").click(function (){
                keep="Y"
                checkLogin()
            })
            function checkLogin(){
                var okNo = isOkNo()
                var okPwd = isOkPwd()
                if(!okNo){
                    flickerNo = 0
                    flickerNoRun = setInterval(function (){
                        var nowColor = $("#submit_no")[0].style.borderColor
                        if(flickerNo == 5)
                            clearInterval(flickerNoRun)
                        if(nowColor==="red")
                            $("#submit_no").css("border-color","#88ddee")
                        else $("#submit_no").css("border-color","red")
                        flickerNo++
                    },200)
                }
                if(!okPwd){
                    flickerPwd = 0
                    flickerPwdRun = setInterval(function (){
                        var nowColor = $("#submit_pwd")[0].style.borderColor
                        if(flickerPwd == 5)
                            clearInterval(flickerPwdRun)
                        if(nowColor==="red")
                            $("#submit_pwd").css("border-color","#88ddee")
                        else $("#submit_pwd").css("border-color","red")
                        flickerPwd++
                    },200)
                }
                if(!isOkCodeFlag){
                    flickerCode = 0
                    flickerCodeRun = setInterval(function (){
                        var nowColor = $("#submit_code")[0].style.borderColor
                        if(flickerCode == 5)
                            clearInterval(flickerCodeRun)
                        if(nowColor==="red")
                            $("#submit_code").css("border-color","#88ddee")
                        else $("#submit_code").css("border-color","red")
                        flickerCode++
                    },200)
                }
                if(isOkNo() && isOkPwd()){
                    submitLogin()
                }
            }
            function submitLogin(){
                $.ajax({
                    url: "/loginServlet.Servlet",
                    type: "post",
                    dataType: "json",
                    data: {
                        userName: $("#submit_no").val(),
                        pwd: $("#submit_pwd").val(),
                        code: $("#submit_code").val(),
                        keep: keep
                    },
                    success: function (data){
                        if(data.success){
                            $("#submit_pwd_alert").text("登陆成功")
                            getUser()
                            setTimeout(function (){
                                $("#mainer form").css("display","block")
                                $("#loginContainer").css("display", "none")
                            },1000)
                        }else {
                            $("#submit_pwd_alert").text(data.message)
                        }
                    }
                })
            }
            $("#code").click(function (){
                $("#code img").attr("src", "/createCodeImageServlet.Servlet?t="+new Date().getTime())
            })
        </script>
    </div>
</div>

<div style="width: 100%;height: 25px;background-color: white;bottom:0;position: fixed">
    <div id="footer">
        <ul>
            <li><a href="">赣ICP备2021003151号</a></li>
            <li><a href="">超星学习通</a></li>
            <li><a href="">ZTC出版社</a></li>
            <li><a href="">中国大学MOOC</a></li>
            <li><a href="">关于我们</a></li>
            <li><a href="">投诉反馈</a></li>
        </ul>
    </div>
</div>

<script src="../js/home.js"></script>

</body>
</html>